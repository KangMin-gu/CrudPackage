<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="user">

    <select id="idCheck" parameterType="String" resultType="hashMap">
     	SELECT *
     	FROM me800010 AS A
		INNER JOIN ma900010 AS B ON A.SITEID = B.SITEID
		WHERE USERID = #{userid}
    </select>
	
	<select id="crudNotice" resultType="hashMap">
		SELECT ICNUM, SUBJECT, DATE_FORMAT(REGDATE,'%Y-%m-%d') AS REGDATE FROM sys990010 LIMIT 5
	</select>
	
	<select id="urMenu" parameterType="String" resultType="hashMap">
		SELECT A.MENUVAL FROM ma900030 AS A
		INNER JOIN me810011 AS B ON B.MENUNO = A.MENUNO
		INNER JOIN me800010 AS C ON C.USERNO = B.USERNO
		WHERE USERID = #{userid}
	</select>
	
	<insert id="loginHistory" parameterType="hashMap">
		INSERT INTO me800011(
		USERNO
		,USERIP
		,USEROS
		,USERDEVICE
		,USERBROWSER
		,VISITYEAR
		,VISITMONTH
		,VISITDAY
		,VISITHOUR
		,REGDATE
		,SITEID
		)VALUES(
		#{userno}
		,#{userip}
		,#{useros}
		,#{userdevice}
		,#{userbrowser}
		,YEAR(NOW())
		,MONTH(NOW())
		,DAY(NOW())
		,HOUR(NOW())
		,NOW()
		,#{siteid}
		)
	</insert>
	
	<select id="useCheck" parameterType="String" resultType="hashMap">
		SELECT B.SITENAME, A.USERNAME, CONCAT(A.MOBILE1,'-',A.MOBILE2,'-',A.MOBILE3) AS MOBILE, CONCAT(A.TELNO1,'-',A.TELNO2,'-',A.TELNO3) AS TELNO
     	FROM me800010 AS A
		INNER JOIN ma900010 AS B ON A.SITEID = B.SITEID
		WHERE USERID = #{userid}
	</select>
</mapper>